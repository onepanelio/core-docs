<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.62">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-106005416-5","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="The open and extensible IDE for computer vision" href="/opensearch.xml">
<script src="/js/gtm.js"></script><title data-react-helmet="true">Built-in model training Workflows | The open and extensible IDE for computer vision</title><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Built-in model training Workflows | The open and extensible IDE for computer vision"><meta data-react-helmet="true" name="description" content="Onepanel - Built-in model training Workflows"><meta data-react-helmet="true" property="og:description" content="Onepanel - Built-in model training Workflows"><meta data-react-helmet="true" property="og:url" content="https://docs.onepanel.ai/docs/reference/workflows/training"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.png"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="true"><link data-react-helmet="true" rel="canonical" href="https://docs.onepanel.ai/docs/reference/workflows/training"><link rel="stylesheet" href="/styles.3a41faa6.css">
<link rel="preload" href="/styles.875de8a4.js" as="script">
<link rel="preload" href="/runtime~main.8f3bd347.js" as="script">
<link rel="preload" href="/main.c259d484.js" as="script">
<link rel="preload" href="/1.29e31e1b.js" as="script">
<link rel="preload" href="/2.2bc60e05.js" as="script">
<link rel="preload" href="/59.6766b1d5.js" as="script">
<link rel="preload" href="/62.1f493b70.js" as="script">
<link rel="preload" href="/935f2afb.2a716644.js" as="script">
<link rel="preload" href="/17896441.0f865ab0.js" as="script">
<link rel="preload" href="/b2033bf3.f5451c67.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/icon.svg" alt="Onepanel logo"><strong class="navbar__title"></strong></a><a class="navbar__item navbar__link" href="/docs/getting-started/quickstart">Getting Started</a><a class="navbar__item navbar__link" href="/docs/reference/overview">User Guide</a><a class="navbar__item navbar__link" href="/docs/deployment/overview">Operator Manual</a><a href="https://github.com/onepanelio/core/releases" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Releases</a><a href="https://github.com/onepanelio/core/milestones?direction=asc&amp;sort=due_date&amp;state=open" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Roadmap</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/onepanelio/onepanel" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-icon-link header-github-link">GitHub</a><a href="https://join.slack.com/t/onepanel-ce/shared_invite/zt-eyjnwec0-nLaHhjif9Y~gA05KuX6AUg" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-icon-link header-slack-link">Slack</a><a href="https://twitter.com/onepanelai" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-icon-link header-twitter-link">Twitter</a><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span><span class="DocSearch-Button-Key">âŒ˜</span><span class="DocSearch-Button-Key">K</span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/icon.svg" alt="Onepanel logo"><strong class="navbar__title"></strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/getting-started/quickstart">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/reference/overview">User Guide</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/deployment/overview">Operator Manual</a></li><li class="menu__list-item"><a href="https://github.com/onepanelio/core/releases" target="_blank" rel="noopener noreferrer" class="menu__link">Releases</a></li><li class="menu__list-item"><a href="https://github.com/onepanelio/core/milestones?direction=asc&amp;sort=due_date&amp;state=open" target="_blank" rel="noopener noreferrer" class="menu__link">Roadmap</a></li><li class="menu__list-item"><a href="https://github.com/onepanelio/onepanel" target="_blank" rel="noopener noreferrer" class="menu__link header-icon-link header-github-link">GitHub</a></li><li class="menu__list-item"><a href="https://join.slack.com/t/onepanel-ce/shared_invite/zt-eyjnwec0-nLaHhjif9Y~gA05KuX6AUg" target="_blank" rel="noopener noreferrer" class="menu__link header-icon-link header-slack-link">Slack</a></li><li class="menu__list-item"><a href="https://twitter.com/onepanelai" target="_blank" rel="noopener noreferrer" class="menu__link header-icon-link header-twitter-link">Twitter</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/reference/overview">User guide</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#!">Workspaces</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/workspaces/launching">Launching a Workspace</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/workspaces/pause-and-resume">Pause and resume</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/workspaces/upgrade">Switching node pool</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/workspaces/delete">Terminating a Workspace</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/workspaces/templates">Workspace Templates</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#!">Workflows</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/workflows/execute">Executing a Workflow</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/workflows/templates">Templates and parameters</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/workflows/artifacts">Working with artifacts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/workflows/create">Creating a Workflow Template</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/workflows/metrics">Persisting training metrics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/workflows/tensorboard">Accessing TensorBoard</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/workflows/hyperparameter-tuning">Hyperparameter tuning</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/workflows/troubleshooting">Troubleshooting Workflows</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Built-in and custom Workflows</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/reference/workflows/training">Model training</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/workflows/data-augmentation">Data augmentation</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#!">CVAT Workspace</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/cvat/quickstart">Getting started with image and video annotation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/cvat/built-in-models">Training with built-in models</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/cvat/automatic-annotation">Using trained models for automatic annotation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/cvat/custom-models">Adding custom training Workflows</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#!">JupyterLab Workspace</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/jupyterlab/overview">JupyterLab overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/jupyterlab/git">Using Git and browsing GitHub</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/jupyterlab/tensorboard">Using TensorBoard</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/jupyterlab/debugging">Using the built-in debugger</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/jupyterlab/language-server">Auto completion and language features</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#!">SDKs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/sdks/python">Python SDK</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><div><span class="badge badge--secondary">Version: Next</span></div><header><h1 class="docTitle_1Lrw">Built-in model training Workflows</h1></header><div class="markdown"><p>Onepanel supports the following built-in models for object detection and semantic segmentation:</p><ul><li>TensorFlow Object Detection API models for object detection.</li><li>MaskRCNN model for semantic segmentation.</li></ul><p>These models are available as training Workflows under <strong>Workflows</strong> &gt; <strong>Workflow Templates</strong> and can be <a href="/docs/reference/cvat/built-in-models">executed from any CVAT Workspace</a> to train on your annotated data.</p><p><a href="/docs/reference/workflows/tensorboard#launching-tensorboard">TensorBoard</a> is also fully integrated and along with real-time logs can be accessed while your model is training.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="tensorflow-object-detection"></a>TensorFlow Object Detection<a aria-hidden="true" tabindex="-1" class="hash-link" href="#tensorflow-object-detection" title="Direct link to heading">#</a></h2><p>You can use any of the supported TensorFlow Object Detection API models to train models on your data. Following is an overview on how to choose one model over another based on your needs. Some models are faster than others, whereas some are more accurate than others.</p><p><img src="/assets/images/built-in-models-160405-6224ff15e804186be0f9ee2dceb06199.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="tfod-hyperparameters"></a>TFOD hyperparameters<a aria-hidden="true" tabindex="-1" class="hash-link" href="#tfod-hyperparameters" title="Direct link to heading">#</a></h3><p>You can specify arguments for all the available models in TFOD in the <code>Hyperparameters</code> field in YAML format.</p><p>Here&#x27;s an example:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">num_steps: </span><span class="token number" style="color:rgb(247, 140, 108)">10000</span><span class="token plain">               </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#  Number of steps. If left empty, Onepanel will pick the recommended defaults for that model.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">batch_size: </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">                  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#  Batch size for the training</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">initial_learning_rate: </span><span class="token number" style="color:rgb(247, 140, 108)">0.0003</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#  Initial learning rate for the model. We recommend you do not change this.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">num_clones: </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">                  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#  Number of GPUs to use for training. Change to number of GPUs for your machine.</span></div></div></div></div></div><p>See <a href="https://github.com/onepanelio/templates/blob/release-v0.18.0/workflows/tf-object-detection-training/defaults.json" target="_blank" rel="noopener noreferrer">this file</a> for all available hyperparameters for each TFOD model. Also see <a href="https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/configuring_jobs.md#picking-model-parameters" target="_blank" rel="noopener noreferrer">picking model parameters</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="choosing-the-right-model"></a>Choosing the right model<a aria-hidden="true" tabindex="-1" class="hash-link" href="#choosing-the-right-model" title="Direct link to heading">#</a></h3><ul><li><p>We currently support several faster-rcnn models. All of these models are similar except that of the backbone used for the feature extraction. The backbones used are, in increasing order of complexity (i.e more layers), ResNet50, ResNet101, InceptionResNetV2. As the model complexity increases the computation requirement will also increase. If you have very complicated data (i.e hundreds of annotations in one image), then it is recommended that you choose complex model (i.e InceptionResNetV2).</p></li><li><p>Faster-rcnn models are generally more accurate than ssd models. However, sometimes you are better off using ssd models if your data is easy to learn (i.e 1 or 2 bounding box per image).</p></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="frcnn-nas-coco"></a>frcnn-nas-coco:<a aria-hidden="true" tabindex="-1" class="hash-link" href="#frcnn-nas-coco" title="Direct link to heading">#</a></h4><ul><li>If you are using <code>frcnn-nas-coco</code>, then choose a machine with at least 2 GPUs as this model requires more memory. A machine with 1 GPU will throw an error.</li></ul><p>This is a type of faster-rcnn model with NAS backbone. If you are not sure about which model to use then we recommend you use SSD based model (i.e ssd-mobilenet-v2).</p><p><strong><em>Defaults</em></strong>: batch_size: 1, learning_rate: 0.0003, epochs=10000</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="frcnn-res101-coco"></a>frcnn-res101-coco:<a aria-hidden="true" tabindex="-1" class="hash-link" href="#frcnn-res101-coco" title="Direct link to heading">#</a></h4><p>This is a type of faster-rcnn model with ResNet101 backbone. If you are not sure about which model to use then we recommend you use SSD based model (i.e ssd-mobilenet-v2). </p><p><strong><em>Defaults</em></strong>: batch_size: 1, learning_rate: 0.0003, epochs=10000</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="frcnn-res101-lowp"></a>frcnn-res101-lowp<a aria-hidden="true" tabindex="-1" class="hash-link" href="#frcnn-res101-lowp" title="Direct link to heading">#</a></h4><p>This is a type of faster-rcnn model with ResNet101 backbone with low number of proposals. If you are not sure about which model to use then we recommend you use SSD based model (i.e ssd-mobilenet-v2). If you are looking for more complex and accurate model then check out frcnn-res101-coco or frcnn-inc-resv2-atr-coco.</p><p><strong><em>Defaults</em></strong>: batch_size: 1, learning_rate: 0.0003, epochs=10000</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="frcnn-res50-coco"></a>frcnn-res50-coco<a aria-hidden="true" tabindex="-1" class="hash-link" href="#frcnn-res50-coco" title="Direct link to heading">#</a></h4><p>This is a type of faster-rcnn model with ResNet50 backbone. If you are not sure about which model to use then we recommend you use SSD based model (i.e ssd-mobilenet-v2). If you are looking for more complex and accurate model then check out frcnn-res101-coco or frcnn-inc-resv2-atr-coco.</p><p><strong><em>Defaults</em></strong>: batch_size: 1, learning_rate: 0.0003, epochs=10000</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="ssd-mobilenet-v2-coco"></a>ssd-mobilenet-v2-coco<a aria-hidden="true" tabindex="-1" class="hash-link" href="#ssd-mobilenet-v2-coco" title="Direct link to heading">#</a></h4><p>SSD-based networks such as <code>ssd-mobilenet-v2</code> are faster than faster-rcnn based models. However, they are not as accurate as faster-rcnn based models. This model is generally recommended since its accurate and fast enough. If you don&#x27;t know much about your data or the complexity of your data, then we recommend you go with this model.</p><p>You will find the pre-trained model and config file for ssd-mobilenetv2 model trained on COCO dataset.</p><p>This model is a good place to start if you don&#x27;t have any specific model in mind. If you are data is very complicated (i.e many annotations per image) then you should prefer faster-rcnn models over ssd.</p><p>Depending upon your data, you can set epochs to train your model. There is no standard value which can work for all datasets. You generally have to try different number of epochs to get the best model. Ideally, you do so by monitoring loss of your model while training. But if you are looking for a recommendation. Then, we recommend you set epochs as follows: (number of images / batch_size (default: 24)) * 1000. For instance, if you have 100 images, then your epochs will be 4000 (rounded). Note that the model will be trained using a pre-trained model, so you don&#x27;t need to train as long as you would have to when not using the pre-trained model.</p><p><strong><em>Defaults</em></strong>: batch_size: 24, learning_rate: 0.004, epochs=10000</p><p>Note that same instructions apply for <strong>ssd-mobilenet-v1</strong> and <strong>ssd-mobilenet-lite</strong>. The only difference is the backbone model (i.e mobilenet v1) that they use.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="maskrcnn"></a>MaskRCNN<a aria-hidden="true" tabindex="-1" class="hash-link" href="#maskrcnn" title="Direct link to heading">#</a></h2><p>MaskRCNN is a popular model for segmentation tasks. We use <a href="https://github.com/matterport/Mask_RCNN" target="_blank" rel="noopener noreferrer">this</a> implementation of MaskRCNN for training and inference.</p><p>The process to train a Mask-RCNN model on CVAT is similar to the above process except that you need to select Mask-RCNN after clicking on Create Annotation Model.</p><p><img src="/assets/images/built-in-models-153544-be0bf4fa9c62c48ee517e9c8d840cccd.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="maskrcnn-hyperparameters"></a>MaskRCNN hyperparameters<a aria-hidden="true" tabindex="-1" class="hash-link" href="#maskrcnn-hyperparameters" title="Direct link to heading">#</a></h3><p>Even though you don&#x27;t need to enter any other parameters to start the training of Mask-RCNN, it is recommended that you pass correct epochs according your data. Mask-RCNN is a very deep model which takes time to train and also to get enough accuracy.</p><p>In addition to <code>num_steps</code>, you can set epochs for three different stages of the model. These parts are called <code>stage_1</code>, <code>stage_2</code> and <code>stage_3</code> and their number of epochs can be set as follows:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">stage_1_epochs: </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#  Epochs for network heads</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">stage_2_epochs: </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#  Epochs for finetune layers</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">stage_3_epochs: </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#  Epochs for all layers</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">num_steps: </span><span class="token number" style="color:rgb(247, 140, 108)">1000</span><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#  Num steps per epoch</span></div></div></div></div></div><p>In <code>stage_1</code>, the model learns to classify from extracted features. In <code>stage_2</code>, the model learns to better extract features. In <code>stage_3</code>, the whole model changes to adapt to new data.</p><p>If you are training images that are similar to the ones in the COCO dataset, it is best to train more epochs in <code>stage_1</code>, otherwise it&#x27;s best to train more epochs in <code>stage_2</code> where the model is learning to better extract features.</p><p>If you have ~1000 images, then you don&#x27;t have to change any parameters.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/onepanelio/core-docs/tree/master/docs/reference/workflows/training.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/reference/workflows/troubleshooting"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Troubleshooting Workflows</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/reference/workflows/data-augmentation"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Built-in data augmentation Workflows Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#tensorflow-object-detection" class="table-of-contents__link">TensorFlow Object Detection</a><ul><li><a href="#tfod-hyperparameters" class="table-of-contents__link">TFOD hyperparameters</a></li><li><a href="#choosing-the-right-model" class="table-of-contents__link">Choosing the right model</a></li></ul></li><li><a href="#maskrcnn" class="table-of-contents__link">MaskRCNN</a><ul><li><a href="#maskrcnn-hyperparameters" class="table-of-contents__link">MaskRCNN hyperparameters</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="text--center"><div>Copyright Â© 2021 Onepanel, Inc.</div></div></div></footer></div>
<script src="/styles.875de8a4.js"></script>
<script src="/runtime~main.8f3bd347.js"></script>
<script src="/main.c259d484.js"></script>
<script src="/1.29e31e1b.js"></script>
<script src="/2.2bc60e05.js"></script>
<script src="/59.6766b1d5.js"></script>
<script src="/62.1f493b70.js"></script>
<script src="/935f2afb.2a716644.js"></script>
<script src="/17896441.0f865ab0.js"></script>
<script src="/b2033bf3.f5451c67.js"></script>
</body>
</html>